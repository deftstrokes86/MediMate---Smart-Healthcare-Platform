{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/auth/protected-route.tsx"],"sourcesContent":["\"use client\";\n\nimport { useAuth } from '@/contexts/auth-context';\nimport { useRouter } from 'next/navigation';\nimport { useEffect } from 'react';\nimport { Loader2 } from 'lucide-react';\n\nconst LoadingSpinner = () => (\n    <div className=\"flex h-screen items-center justify-center bg-background\">\n        <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\n        <p className=\"ml-4 text-lg\">Loading...</p>\n    </div>\n);\n\nconst ProtectedRoute = ({ children, allowedRoles }: { children: React.ReactNode, allowedRoles: string[] }) => {\n  const { user, loading } = useAuth();\n  const router = useRouter();\n\n  useEffect(() => {\n    if (loading) return; // Don't do anything while loading\n\n    // If loading is finished and there's no user, redirect to login\n    if (!user) {\n      console.log(\"ProtectedRoute: No user found, redirecting to login.\");\n      router.replace('/login');\n      return;\n    }\n\n    // If user exists, but their role is not allowed\n    if (!allowedRoles.includes(user.role!)) {\n      console.error(`Access Denied: User role '${user.role}' is not in allowed roles [${allowedRoles.join(', ')}].`);\n      router.replace('/dashboard'); // Redirect to a default safe page\n    }\n  }, [user, loading, router, allowedRoles]);\n\n  if (loading || !user || !allowedRoles.includes(user.role!)) {\n    // Show a loading spinner or a skeleton screen while checking auth\n    return <LoadingSpinner />;\n  }\n\n  // If everything is fine, render the children\n  return <>{children}</>;\n};\n\nexport default ProtectedRoute;\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOA,MAAM,iBAAiB,kBACnB,8OAAC;QAAI,WAAU;;0BACX,8OAAC,iNAAA,CAAA,UAAO;gBAAC,WAAU;;;;;;0BACnB,8OAAC;gBAAE,WAAU;0BAAe;;;;;;;;;;;;AAIpC,MAAM,iBAAiB,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAyD;IACvG,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,mIAAA,CAAA,UAAO,AAAD;IAChC,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,SAAS,QAAQ,kCAAkC;QAEvD,gEAAgE;QAChE,IAAI,CAAC,MAAM;YACT,QAAQ,GAAG,CAAC;YACZ,OAAO,OAAO,CAAC;YACf;QACF;QAEA,gDAAgD;QAChD,IAAI,CAAC,aAAa,QAAQ,CAAC,KAAK,IAAI,GAAI;YACtC,QAAQ,KAAK,CAAC,CAAC,0BAA0B,EAAE,KAAK,IAAI,CAAC,2BAA2B,EAAE,aAAa,IAAI,CAAC,MAAM,EAAE,CAAC;YAC7G,OAAO,OAAO,CAAC,eAAe,kCAAkC;QAClE;IACF,GAAG;QAAC;QAAM;QAAS;QAAQ;KAAa;IAExC,IAAI,WAAW,CAAC,QAAQ,CAAC,aAAa,QAAQ,CAAC,KAAK,IAAI,GAAI;QAC1D,kEAAkE;QAClE,qBAAO,8OAAC;;;;;IACV;IAEA,6CAA6C;IAC7C,qBAAO;kBAAG;;AACZ;uCAEe","debugId":null}}]
}